{% extends 'base.html' %}


{% block main %} 


{%if current_user.username == null %}
    <h2>Välkommen till Natura!</h2> 

{%else%}
    <h2>Välkommen {{  current_user.username  }}!</h2>
{%endif%}

    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Error repudiandae amet quod ab autem reiciendis, distinctio quaerat magnam hic repellendus odio et nesciunt. Deserunt quaerat beatae laudantium laborum, reiciendis sint. Lorem ipsum dolor sit amet consectetur adipisicing elit. Qui quam atque quasi libero! A voluptatem dignissimos vitae deleniti, natus quibusdam aliquam sunt, voluptate consectetur nam omnis libero veniam veritatis dolorum! Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facilis sunt placeat sequi autem inventore repudiandae tempora. Nihil maiores assumenda voluptate, voluptatem, cum delectus quas sequi cupiditate, enim nulla rerum excepturi. Lorem ipsum dolor sit, amet consectetur adipisicing elit. Reprehenderit consequuntur est iure ea dolorum! Facilis nostrum repellat, ratione officia maxime minima debitis doloribus itaque adipisci veniam esse, voluptates, voluptas possimus? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptates esse sequi cum in quae! Atque asperiores vel corporis nisi? Laudantium quae ipsum ducimus cumque, aut ullam quasi qui minima hic! Lorem ipsum dolor sit amet, consectetur adipisicing elit. Neque labore veritatis ut iure officia ducimus, tempore deleniti, laborum consequatur necessitatibus expedita nisi enim animi sit, autem at vel. Commodi, iure?</p>
{% endblock %}

{% block aside%}
<aside>
       

<div id="map"></div>
<script>
    // The map
	mapboxgl.accessToken = 'pk.eyJ1IjoiaGFubmlsczk4IiwiYSI6ImNrOGgxNGs1ejAydG8zaGxmcjFhNGc3MmsifQ.bmfahnTIFCFL9n9WJAGsYw';
    var map = new mapboxgl.Map({
        container: 'map', // container id
        style: 'mapbox://styles/hannils98/ck8hfxoua1ftp1ioi5jjggbyj', // stylesheet location
        center: [13.582728,55.893180], // starting position [lng, lat]
        zoom: 7, // starting zoom
        minZoom: 7,
        maxZoom: 16
        });

    // Add zoom and rotation controls to the map.
    map.addControl(new mapboxgl.NavigationControl());


    // Add pop-up
    map.on('click', function(e) {
        var features = map.queryRenderedFeatures(e.point, {
            layers: ['places'] 
        });

        if (!features.length) {
            return;
        }

        var feature = features[0];

        var popup = new mapboxgl.Popup({ offset: [0, -15] })
            .setLngLat(feature.geometry.coordinates)
            .setHTML('<h3><a href="/place/'+ feature.properties.id + '">' + feature.properties.title + '</a></h3><p>'+ feature.properties.description +'</p>')
            .addTo(map);
        });

    // get users location    
    map.addControl(
    new mapboxgl.GeolocateControl({
        positionOptions: {
            enableHighAccuracy: true
        },
        trackUserLocation: true
        }));     

        // Vet inte vad detta gör har därför inte tagit bort det    

          //  map.on('click', 'places', function(e) {
  //          var coordinates = e.features[0].geometry.coordinates.slice();
  //          var description = e.features[0].properties.description;

            // Ensure that if the map is zoomed out such that multiple
            // copies of the feature are visible, the popup appears
            // over the copy being pointed to.
  //          while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
  //              coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
  //          }
  //      });

   //     map.addControl(
   //     new mapboxgl.GeolocateControl({
  //          positionOptions: {
   //             enableHighAccuracy: true
   //         },
   //         trackUserLocation: true
   //     })
  //  );               
        
</script>     
    
</aside>


{%endblock%}