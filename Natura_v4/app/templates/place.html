{% extends 'base.html'%}

{% block content%}
{{super()}}

    <h2>{{ name }}</h2>
    {%for image in admin_images%}
    <img style="height: auto; width: 200px; padding: 10px; display: block;" src="/app/static/uploads/{{image}}"
        alt="{{image}}">
    {%endfor%}
    <div id="addimage">
        {% if current_user.username != null %}
        <h3>Lägg upp bild:</h3>
        {{ dropzone.create(action_view='place', category=category, name=name, placeid=placeid) }}
        {{ dropzone.config(redirect_url=url_for('place', category=category, name=name, placeid=placeid)) }}
        {% endif %}
    </div>
    <div class="show_ratings">
        <h4>Betyg</h4>
        <p>Medelbetyg:</p>
        <div class="average_ratings">
            <span class="fa fa-star-o"></span>
            <span class="fa fa-star-o"></span>
            <span class="fa fa-star-o"></span>
            <span class="fa fa-star-o"></span>
            <span class="fa fa-star-o"></span>
            <span>{{ average_rating }}</span>
            <input type=hidden id="ave_rating" name="ave_rating" value="{{ average_rating }}">
        </div>
        {%if current_user.is_authenticated%}
        <p>Ditt betyg:</p>
        <div class="user_rating">
            <span class="fa fa-star-o"></span>
            <span class="fa fa-star-o"></span>
            <span class="fa fa-star-o"></span>
            <span class="fa fa-star-o"></span>
            <span class="fa fa-star-o"></span>
            <input type=hidden id="user_rating" name="user_rating" value="{{ saved_rating }}">
        </div>
        {%endif%}
    </div>
    <ul>
        {%for i in info%}
        <p> {{ i.description }} </p>
        <p> Läs mer: <a href="{{ i.source }}">{{ i.source }} </a></p>
        {%endfor%}
    </ul>

    <a href="{{ url_for('category', category=category) }}">Tillbaka</a>

    <h2>Bilder:</h2>
    {%for image in user_images%}
    <img style="height: auto; width: 200px; padding: 10px; display: block;" src="/app/static/uploads/{{image}}"
        alt="{{image}}">
    {%endfor%}
    
{% endblock content %}



{% block map%}
<div id='map'>

</div>

{%for i in info%}
    <input type=hidden id="longitude" name="longitude" value="{{ i.longitude }}">
    <input type=hidden id="latitude" name="latitude" value="{{ i.latitude }}">
{%endfor%}

<script>
    // The map
    var longitude = document.getElementById('longitude').value
    var latitude = document.getElementById('latitude').value
    mapboxgl.accessToken =
        'pk.eyJ1IjoiaGFubmlsczk4IiwiYSI6ImNrOGgxNGs1ejAydG8zaGxmcjFhNGc3MmsifQ.bmfahnTIFCFL9n9WJAGsYw';
    var map = new mapboxgl.Map({
        container: 'map', // container id
        style: 'mapbox://styles/hannils98/ck8hfxoua1ftp1ioi5jjggbyj', // stylesheet location
        center: [longitude, latitude], // starting position [lng, lat]
        zoom: 12, // starting zoom
        minZoom: 7,
        maxZoom: 16
    });
</script>


{% endblock map%}

{% block scripts %}
<script src="{{ url_for('static', filename='betyg.js') }}" type="text/javascript"></script>
<script src='https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.js'></script>
<script src="{{ url_for( 'static', filename= 'mapplace.js')}}"></script>
{{super()}}
{% endblock scripts %}